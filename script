local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local TweenService = game:GetService("TweenService")

-- Create ScreenGui
local RejoinGui = Instance.new("ScreenGui")
RejoinGui.Name = "RejoinGui"
RejoinGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

-- Create main frame
local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 200, 0, 60)
Frame.Position = UDim2.new(0.5, -100, 0.5, -30)
Frame.AnchorPoint = Vector2.new(0.5, 0.5)
Frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
Frame.BackgroundTransparency = 0.2
Frame.Parent = RejoinGui

-- Create button
local Button = Instance.new("TextButton")
Button.Name = "RejoinButton"
Button.Size = UDim2.new(0.9, 0, 0.7, 0)
Button.Position = UDim2.new(0.05, 0, 0.15, 0)
Button.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
Button.TextColor3 = Color3.white
Button.Text = "REJOIN GAME"
Button.Font = Enum.Font.GothamBold
Button.TextSize = 18
Button.Parent = Frame

-- Button effects
Button.MouseEnter:Connect(function()
    TweenService:Create(Button, TweenInfo.new(0.2), {
        BackgroundColor3 = Color3.fromRGB(255, 80, 80),
        Size = UDim2.new(0.92, 0, 0.72, 0)
    }):Play()
end)

Button.MouseLeave:Connect(function()
    TweenService:Create(Button, TweenInfo.new(0.2), {
        BackgroundColor3 = Color3.fromRGB(255, 60, 60),
        Size = UDim2.new(0.9, 0, 0.7, 0)
    }):Play()
end)

-- Rejoin functionality
Button.MouseButton1Click:Connect(function()
    Button.Text = "REJOINING..."
    Button.BackgroundColor3 = Color3.fromRGB(100, 255, 100)
    
    local teleportService = game:GetService("TeleportService")
    local placeId = game.PlaceId
    local jobId = game.JobId
    
    local success, errorMsg = pcall(function()
        teleportService:TeleportToPlaceInstance(placeId, jobId, LocalPlayer)
    end)
    
    if not success then
        teleportService:Teleport(placeId, LocalPlayer)
    end
end)

-- Make draggable
local UserInputService = game:GetService("UserInputService")
local dragging
local dragInput
local dragStart
local startPos

local function update(input)
    local delta = input.Position - dragStart
    Frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

Frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = Frame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

Frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)
